<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Detection Hub | Medical & Audio Analysis</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='14' fill='%23111827'/%3E%3Ccircle cx='32' cy='32' r='18' stroke='%2360A5FA' stroke-width='4' fill='none'/%3E%3Cpath d='M32 20v24M20 32h24' stroke='%2334D399' stroke-width='3' stroke-linecap='round'/%3E%3C/svg%3E">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Global zoom for better display -->
    <style>
        html {
            font-size: 14px;
            zoom: 0.7;
        }
    </style>

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">

</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="app-header">
            <div class="header-brand">
                <div class="brand-logo">
                    <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="20" cy="20" r="16" stroke="currentColor" stroke-width="2.5"/>
                        <path d="M20 10v20M10 20h20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <circle cx="20" cy="20" r="6" fill="currentColor" opacity="0.3"/>
                    </svg>
                </div>
                <div class="brand-text">
                    <h1>AI Detection Hub</h1>
                    <span class="brand-tagline">Explainable AI for Medical & Audio Analysis</span>
                </div>
            </div>
            <div class="header-actions">
                <!-- Backend Status Indicator (compact) -->
                <div class="backend-status-compact" id="backend-status-container"></div>
                <button class="theme-toggle" id="theme-toggle" title="Toggle theme">
                    <span class="theme-icon-light">‚òÄÔ∏è</span>
                    <span class="theme-icon-dark">üåô</span>
                </button>
            </div>
        </header>

        <!-- Main Navigation Tabs -->
        <nav class="detector-tabs" id="detector-tabs">
            <button class="detector-tab active" data-detector="lung-cancer">
                <span class="tab-icon">ü´Å</span>
                <span class="tab-label">Lung Cancer Detection</span>
                <span class="tab-badge">AI</span>
            </button>
            <button class="detector-tab" data-detector="audio-fake">
                <span class="tab-icon">üéôÔ∏è</span>
                <span class="tab-label">Audio Deepfake Detection</span>
                <span class="tab-badge">AI</span>
            </button>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Lung Cancer Detection View -->
            <section class="detector-view active" id="lung-cancer-view">
                <div class="view-header">
                    <div class="view-title-group">
                        <h2 class="view-title">Lung Cancer Detection</h2>
                        <p class="view-description">Analyze lung CT scan images using deep learning with explainable AI visualization to understand model predictions.</p>
                    </div>
                </div>

                <div class="detector-layout">
                    <!-- Upload Section -->
                    <div class="upload-section">
                        <div class="upload-card">
                            <h3 class="card-title">
                                <span class="card-icon">üì§</span>
                                CT Scan Image
                            </h3>
                            
                            <div class="upload-zone" id="lung-upload-zone">
                                <div class="upload-zone-content">
                                    <div class="upload-icon">
                                        <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M24 32V16M24 16L18 22M24 16L30 22" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M8 32v6a4 4 0 004 4h24a4 4 0 004-4v-6" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
                                        </svg>
                                    </div>
                                    <p class="upload-text">Drop your CT scan image here</p>
                                    <p class="upload-hint">or click to select a file</p>
                                    <p class="upload-formats">PNG, JPG, JPEG ‚Ä¢ Max 10 MB</p>
                                </div>
                                <input type="file" id="lung-file-input" accept="image/png,image/jpeg,image/jpg" hidden>
                            </div>

                            <!-- Image Preview -->
                            <div class="image-preview hidden" id="lung-image-preview">
                                <img id="lung-preview-img" src="" alt="CT scan preview">
                                <button class="preview-remove" id="lung-preview-remove" title="Remove and select another image">√ó</button>
                                <div class="preview-filename" id="lung-preview-filename"></div>
                            </div>

                            <!-- XAI Method Selection -->
                            <div class="xai-selection">
                                <h4 class="selection-title">
                                    <span class="selection-icon">üî¨</span>
                                    Explainability Method
                                </h4>
                                <p class="selection-description">Select how the model should explain its prediction</p>
                                
                                <div class="xai-options" id="lung-xai-options">
                                    <label class="xai-option">
                                        <input type="radio" name="lung-xai-method" value="gradcam" checked>
                                        <div class="xai-option-content">
                                            <div class="xai-option-header">
                                                <span class="xai-name">Grad-CAM</span>
                                                <span class="xai-badge recommended">Recommended</span>
                                            </div>
                                            <p class="xai-description">Highlights regions that influenced the prediction using gradient-based heatmap visualization.</p>
                                        </div>
                                    </label>
                                    
                                    <label class="xai-option">
                                        <input type="radio" name="lung-xai-method" value="lime">
                                        <div class="xai-option-content">
                                            <div class="xai-option-header">
                                                <span class="xai-name">LIME</span>
                                                <span class="xai-badge">Interpretable</span>
                                            </div>
                                            <p class="xai-description">Shows which image segments (superpixels) contributed most to the classification.</p>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <!-- Submit Button -->
                            <button class="submit-btn" id="lung-submit-btn" disabled>
                                <span class="btn-icon">üîç</span>
                                <span class="btn-text">Run Analysis</span>
                                <span class="btn-loader"></span>
                            </button>
                        </div>
                    </div>

                    <!-- Results Section -->
                    <div class="results-section">
                        <div class="results-card" id="lung-results-card">
                            <!-- Empty State -->
                            <div class="results-empty" id="lung-results-empty">
                                <div class="empty-icon">
                                    <svg viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="40" cy="40" r="30" stroke="currentColor" stroke-width="2" opacity="0.3"/>
                                        <path d="M40 25v30M25 40h30" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity="0.5"/>
                                    </svg>
                                </div>
                                <h3>Ready for Analysis</h3>
                                <p>Upload a CT scan image to detect potential lung abnormalities</p>
                            </div>

                            <!-- Loading State -->
                            <div class="results-loading hidden" id="lung-results-loading">
                                <div class="loading-spinner">
                                    <div class="spinner-ring"></div>
                                    <div class="spinner-ring"></div>
                                    <div class="spinner-ring"></div>
                                </div>
                                <h3>Processing...</h3>
                                <p class="loading-step" id="lung-loading-step">Initializing model</p>
                            </div>

                            <!-- Results Content -->
                            <div class="results-content hidden" id="lung-results-content">
                                <!-- Prediction Result -->
                                <div class="result-prediction" id="lung-prediction">
                                    <div class="prediction-icon" id="lung-prediction-icon">‚úì</div>
                                    <div class="prediction-details">
                                        <h3 class="prediction-label" id="lung-prediction-label">Diagnosis Result</h3>
                                        <p class="prediction-value" id="lung-prediction-value">--</p>
                                    </div>
                                    <div class="prediction-confidence">
                                        <span class="confidence-label">Confidence</span>
                                        <span class="confidence-value" id="lung-confidence-value">--%</span>
                                    </div>
                                </div>

                                <!-- XAI Visualization -->
                                <div class="xai-visualization">
                                    <h4 class="section-title">
                                        <span class="section-icon">üß†</span>
                                        Model Explanation
                                    </h4>
                                    <p class="section-description">
                                        <span id="lung-xai-method-name">Grad-CAM</span> visualization ‚Äî areas that influenced the model's decision
                                    </p>
                                    <div class="xai-image-container">
                                        <img id="lung-xai-image" src="" alt="XAI explanation visualization">
                                    </div>
                                    <!-- XAI Legend -->
                                    <div class="xai-legend" id="lung-xai-legend"></div>
                                </div>

                                <!-- Additional Info -->
                                <div class="result-meta">
                                    <div class="meta-item">
                                        <span class="meta-label">Processing Time</span>
                                        <span class="meta-value" id="lung-duration">--</span>
                                    </div>
                                    <div class="meta-item">
                                        <span class="meta-label">XAI Method</span>
                                        <span class="meta-value" id="lung-xai-used">--</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Audio Fake Detection View -->
            <section class="detector-view" id="audio-fake-view">
                <div class="view-header">
                    <div class="view-title-group">
                        <h2 class="view-title">Audio Deepfake Detection</h2>
                        <p class="view-description">Detect AI-generated or manipulated audio using spectrogram analysis with explainable AI visualization.</p>
                    </div>
                </div>

                <div class="detector-layout">
                    <!-- Upload Section -->
                    <div class="upload-section">
                        <div class="upload-card">
                            <h3 class="card-title">
                                <span class="card-icon">üì§</span>
                                Audio File
                            </h3>
                            
                            <div class="upload-zone" id="audio-upload-zone">
                                <div class="upload-zone-content">
                                    <div class="upload-icon">
                                        <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M24 32V16M24 16L18 22M24 16L30 22" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M8 32v6a4 4 0 004 4h24a4 4 0 004-4v-6" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
                                        </svg>
                                    </div>
                                    <p class="upload-text">Drop your audio file here</p>
                                    <p class="upload-hint">or click to select a file</p>
                                    <p class="upload-formats">WAV, MP3, FLAC, OGG ‚Ä¢ Max 50 MB</p>
                                </div>
                                <input type="file" id="audio-file-input" accept="audio/wav,audio/mp3,audio/mpeg,audio/flac,audio/ogg,.wav,.mp3,.flac,.ogg" hidden>
                            </div>

                            <!-- Audio Preview -->
                            <div class="audio-preview hidden" id="audio-preview">
                                <div class="audio-preview-header">
                                    <div class="audio-preview-info">
                                        <span class="audio-icon">üéµ</span>
                                        <span class="audio-filename" id="audio-preview-filename">audio.wav</span>
                                    </div>
                                    <button class="audio-remove-btn" id="audio-preview-remove" title="Remove and select another file">
                                        <span>‚úï</span> Remove
                                    </button>
                                </div>
                                <audio controls id="audio-player" class="audio-player"></audio>
                            </div>

                            <!-- XAI Method Selection -->
                            <div class="xai-selection">
                                <h4 class="selection-title">
                                    <span class="selection-icon">üî¨</span>
                                    Explainability Method
                                </h4>
                                <p class="selection-description">Select how the model should explain its prediction on the spectrogram</p>
                                
                                <div class="xai-options" id="audio-xai-options">
                                    <label class="xai-option">
                                        <input type="radio" name="audio-xai-method" value="gradcam" checked>
                                        <div class="xai-option-content">
                                            <div class="xai-option-header">
                                                <span class="xai-name">Grad-CAM</span>
                                                <span class="xai-badge recommended">Recommended</span>
                                            </div>
                                            <p class="xai-description">Highlights frequency regions that influenced the prediction using gradient-based heatmap.</p>
                                        </div>
                                    </label>
                                    
                                    <label class="xai-option">
                                        <input type="radio" name="audio-xai-method" value="lime">
                                        <div class="xai-option-content">
                                            <div class="xai-option-header">
                                                <span class="xai-name">LIME</span>
                                                <span class="xai-badge">Interpretable</span>
                                            </div>
                                            <p class="xai-description">Shows which spectrogram segments contributed most to the classification.</p>
                                        </div>
                                    </label>
                                    
                                    <label class="xai-option">
                                        <input type="radio" name="audio-xai-method" value="shap">
                                        <div class="xai-option-content">
                                            <div class="xai-option-header">
                                                <span class="xai-name">SHAP</span>
                                                <span class="xai-badge">Advanced</span>
                                            </div>
                                            <p class="xai-description">Game theory-based attribution showing features pushing toward fake (red) or real (blue).</p>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <!-- Submit Button -->
                            <button class="submit-btn" id="audio-submit-btn" disabled>
                                <span class="btn-icon">üîç</span>
                                <span class="btn-text">Run Analysis</span>
                                <span class="btn-loader"></span>
                            </button>
                        </div>
                    </div>

                    <!-- Results Section -->
                    <div class="results-section">
                        <div class="results-card" id="audio-results-card">
                            <!-- Empty State -->
                            <div class="results-empty" id="audio-results-empty">
                                <div class="empty-icon">
                                    <svg viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="40" cy="40" r="30" stroke="currentColor" stroke-width="2" opacity="0.3"/>
                                        <path d="M40 25v30M25 40h30" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity="0.5"/>
                                    </svg>
                                </div>
                                <h3>Ready for Analysis</h3>
                                <p>Upload an audio file to detect potential AI-generated content</p>
                            </div>

                            <!-- Loading State -->
                            <div class="results-loading hidden" id="audio-results-loading">
                                <div class="loading-spinner">
                                    <div class="spinner-ring"></div>
                                    <div class="spinner-ring"></div>
                                    <div class="spinner-ring"></div>
                                </div>
                                <h3>Processing...</h3>
                                <p class="loading-step" id="audio-loading-step">Initializing model</p>
                            </div>

                            <!-- Results Content -->
                            <div class="results-content hidden" id="audio-results-content">
                                <!-- Prediction Result -->
                                <div class="result-prediction" id="audio-prediction">
                                    <div class="prediction-icon" id="audio-prediction-icon">‚úì</div>
                                    <div class="prediction-details">
                                        <h3 class="prediction-label" id="audio-prediction-label">Detection Result</h3>
                                        <p class="prediction-value" id="audio-prediction-value">--</p>
                                    </div>
                                    <div class="prediction-confidence">
                                        <span class="confidence-label">Confidence</span>
                                        <span class="confidence-value" id="audio-confidence-value">--%</span>
                                    </div>
                                </div>

                                <!-- XAI Visualization -->
                                <div class="xai-visualization">
                                    <h4 class="section-title">
                                        <span class="section-icon">üß†</span>
                                        Model Explanation
                                    </h4>
                                    <p class="section-description">
                                        <span id="audio-xai-method-name">Grad-CAM</span> visualization ‚Äî areas that influenced the model's decision
                                    </p>
                                    <div class="xai-image-container">
                                        <img id="audio-xai-image" src="" alt="XAI explanation visualization">
                                    </div>
                                    <!-- XAI Legend -->
                                    <div class="xai-legend" id="audio-xai-legend"></div>
                                </div>

                                <!-- Additional Info -->
                                <div class="result-meta">
                                    <div class="meta-item">
                                        <span class="meta-label">Processing Time</span>
                                        <span class="meta-value" id="audio-duration">--</span>
                                    </div>
                                    <div class="meta-item">
                                        <span class="meta-label">XAI Method</span>
                                        <span class="meta-value" id="audio-xai-used">--</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <p>&copy; 2025 AI Detection and XAI ‚Äî ESILV Master Data & AI (XAI Course)</p>

            <p class="footer-group">
                Project group (DIA1):
                <br>
                Leo Gasperowicz<br>
                Lo√Øc Beaurain<br>
                Florian Barre<br>
                Rachid Ait Ameur
            </p>

            <p class="footer-disclaimer">
                Academic project conducted as part of the DIA1 track.
            </p>
        </footer>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Scripts -->
    <script type="module" src="js/app.js"></script>
</body>
</html>
